Перемещение продуктов в группе и области
===

Структура данных
---

- область (авиа)
  - группы (B, R, G)
    - продукты (Абакан, Деметра)


Нормализованный вид
---

область
- ид
- название

группа
- ид
- область_ид

продукт
- ид
- название
- цвет
- группа_ид (группа обязательна для каждого продукта)
- позиция_в_области
- позиция_в_группе (вычисляемое поле по позиции_в_области)


Вычисляемые поля
---

- позиции всех продуктов в группах могут вычислится по позициям в области
- позиции всех продуктов в области не могут однозначно вычислится по позициям в группах


Алгоритм "Перемещение в области"
---

- пользователь перемещает продукт в области: moveInArea(productId, to)
- позиция продукта в группе автоматически вычисляется по позиции в области


Алгоритм "Перемещение в группе"
---

- пользователь перемещает продукт в группе (например, с первой позиции на последнюю)
- изменение позиции в группе происходит косвенно - через изменение позиции в области
- во время перемещения, новая позиция в области вычисляется на основе:
  - новой позиции в группе
  - ? предшествующего/последующего продукта
  - ? всех элементов области данной группы

Ньюансы

- перемещённый в группе (например вниз) элемент становится в области **сразу же после** своего предшественника. С таким же успехом, может быть некий отступ вместо **сразу же после**. Например, продукт, перемещённый в группе в самый низ, становится в самый низ и в области. В итоге перемещение продукта в группе порождает неоднозначное для пользователя поведение в области (общем блоке). Варианты однозначного поведения:
  - запретить перемещение в списках групп (только для чтения). Сортировка только в общем списке
  - запретить перемещение в общем списке (только для чтения). Сортировка только в списках групп.
